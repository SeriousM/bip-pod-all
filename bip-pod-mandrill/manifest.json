{
  "name": "mandrill",
  "title": "Mandrill",
  "description": "Mandrill is a transactional email platform from MailChimp",
  "url": "https://mandrill.com",
  "trackDuplicates": false,
  "config": {},
  "auth": {
    "strategy": "issuer_token",
    "properties": {
      "password": {
        "type": "string",
        "title": "API Key"
      }
    }
  },
  "rpcs": {},
  "actions": {
		  "send_template": {
		      "title": "Send a Template Email",
		      "description": "Send an Email using a predefined template",
		      "doc_ref": "https://mandrillapp.com/api/docs/messages.JSON.html",
		      "trigger": "invoke",
		      "config": {
		        "properties": {
		          "from_email": {
		            "type": "string",
		            "title": "Default From Address"
		          },
		          "from_name": {
		            "type": "string",
		            "title": "From Name"
		          }
		          ,
		          "template_name": {
		            "type": "string",
		            "title": "Template Name"
		          },
              "merge_language" : {
                "type" : "string",
                "title" : "Merge Language",
                "oneOf" : [
                  {
                    "$ref" : "#/imports/definitions/merge_language"
                  }
                ]
              }
		        },
		        "required": [
              "from_email",
              "from_name",
              "template_name",
              "merge_language"
		        ],
		        "disposition": [
		          "from_email",
		          "from_name",
              "template_name",
              "merge_language"
		        ]
		      },
		      "exports": {
		        "properties": {
		          "email": {
		            "type": "string",
		            "title": "Email Address"
		          },
		          "status": {
		            "type": "string",
		            "title": "Status"
		          },
		          "_id": {
		            "type": "string",
		            "title": "Message ID"
		          },
		          "reject_reason": {
		            "type": "string",
		            "title": "Rejection Reason"
		          }
		        }
		      },
		      "imports": {
		        "properties": {
		          "to_email": {
		            "type": "string",
		            "title": "To Address"
		          },
		          "subject": {
		            "type": "string",
		            "title": "Subject"
		          },
		          "merge_vars": {
		            "type": "string",
		            "title": "Merge Variables",
                "description" : "Comma Separated, eg: name=joe,company=big-co"
		          },
              "merge_language" : {
                "type" : "string",
                "title" : "Merge Language",
                "oneOf" : [
                  {
                    "$ref" : "#/imports/definitions/merge_language"
                  }
                ]
              }
		        },

		        "required": [
              "to_email",
              "subject"
		        ],
		        "disposition": [
		          "to_email",
		          "subject",
		          "merge_vars",
              "merge_language"
		        ],
            "definitions": {
              "merge_language": {
                "description": "Merge Language",
                "enum": [
                  "mailchimp",
                  "handlebars"
                ],
                "enum_label": [
                  "MailChimp",
                  "Handlebars"
                ],
                "default": "handlebars"
              }
            }
		      }
		    },
    "send": {
      "title": "Send an Email",
      "description": "Send an Email",
      "doc_ref": "https://mandrillapp.com/api/docs/messages.JSON.html",
      "trigger": "invoke",
      "config": {
        "properties": {
          "from_email": {
            "type": "string",
            "title": "Default From Address"
          },
          "from_name": {
            "type": "string",
            "title": "From Name"
          }
        },
        "required": [
          "from_email"
        ],
        "disposition": [
          "from_email",
          "from_name"
        ]
      },
      "exports": {
        "properties": {
          "email": {
            "type": "string",
            "title": "Email Address"
          },
          "status": {
            "type": "string",
            "title": "Status"
          },
          "_id": {
            "type": "string",
            "title": "Message ID"
          },
          "reject_reason": {
            "type": "string",
            "title": "Rejection Reason"
          }
        }
      },
      "imports": {
        "properties": {
          "to_email": {
            "type": "string",
            "title": "To Address"
          },
          "cc_address": {
            "type": "string",
            "title": "Cc (space separated)"
          },
          "bcc_address": {
            "type": "string",
            "title": "Bcc (space separated)"
          },
          "subject": {
            "type": "string",
            "title": "Subject"
          },
          "text": {
            "type": "string",
            "title": "Text"
          },
          "html": {
            "type": "string",
            "title": "HTML"
          }
        },
        "required": [
          "from_email",
          "to_email"
        ],
        "disposition": [
          "from_email",
          "to_email",
          "cc_address",
          "bcc_address",
          "subject",
          "text",
          "html"
        ]
      }
    }
  }
}